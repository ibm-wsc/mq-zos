
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="IBM MQ for z/OS">
      
      
        <meta name="author" content="IBM Z WSC">
      
      
        <link rel="canonical" href="https://github.com/ibm-wsc/mq-zos/Blog/Task%20record%20information/">
      
      
        <link rel="prev" href="../Symptoms%20that%20led%20to%20PD/">
      
      
      
      <link rel="icon" href="../../assets/wsc-logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.46">
    
    
      
        <title>Task Record Information - IBM MQ for z/OS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"IBM Plex Sans";--md-code-font:"IBM Plex Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="IBM MQ for z/OS" class="md-header__button md-logo" aria-label="IBM MQ for z/OS" data-md-component="logo">
      
  <img src="../../assets/wsc-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IBM MQ for z/OS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Task Record Information
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ibm-wsc/mq-zos" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="IBM MQ for z/OS" class="md-nav__button md-logo" aria-label="IBM MQ for z/OS" data-md-component="logo">
      
  <img src="../../assets/wsc-logo.png" alt="logo">

    </a>
    IBM MQ for z/OS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ibm-wsc/mq-zos" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../certificates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Certificate Management
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../new-queue-manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring a New Queue Manager
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../connectivity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Connectivity to Lab Environment
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../comparing-offloading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparing Offloading Lab
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mp1b/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MP1B Lab
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../queue-statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Queue Statistics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../streaming-queues/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Streaming Queues Lab
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security Lab
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../archive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Archived Materials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" checked>
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MQSMF Blog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            MQSMF Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CF%20calls%20Generated%20by%20an%20MQGET%20Query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CF Calls Generated by an MQGET Query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MultipleQSGAndViews/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiple QSG And Views
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Symptoms%20that%20led%20to%20PD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Symptoms that led to problem determination
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Task Record Information
  </span>
  

      </a>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Task Record Information</h1>

<p>Task Records information</p>
<p>A question we have already started receiving is whether we shall continue to need the Accounting class 
3 records once customers have fully implemented the new queue statistics that became available in MQ 
V9.3.3. The answer is simply yes, and we have a good example of why that detailed level of information 
may be needed in this post. We have now found that there are occasions when we must look at the 
details the requests made to Coupling Facility when using shared queues. This post is the beginning of 
how we examined the queue manager conversion from an MQ API request to the CF requests. That 
information is only found in the WQ records, part of the Task Accounting data.</p>
<p>1) At the WSC we use MQSMFCSV to convert the MQ SMF records (all types and sub-types) to CSV 
files and to generate the DDL for Db2. We use the DDL to build the tables within a Db2 
database, then load the CSV files into the appropriate tables. The names of the fields used in 
this document are those set by MQSMFCSV. If you are using a different SMF record parser or a 
database other than Db2, this information will have to be translated into the formats used by 
the different tools.</p>
<p>2) A task to MQ is created for a connection to the QM from any type of workload (CICS, IMS, Db2, 
RRS, TSO, Batch, CHIN, or client connections via the channel initiator). A task will always have a 
task ID associated with it, it is a 33 byte character field that is used to correlate the WTID, WTAS 
and WQ records associated with the task. The field has different names based on the record and 
is called WTAS_CORRELATOR in the WTID, or task identification record, CORREL in the WTAS, or 
Task Statistics record, and CORRELATION in the WQ or queue information record(s).</p>
<p>3) The task records are always created at task end and may also be created at the SMF intervals for 
tasks that span more than one SMF interval. These are known as Long Running Tasks (LRT). The 
accounting SMF interval is controlled by the ACCTIME in the ZPRM member and defaults to -1 or 
produce Accounting SMF at the same intervals as the Statistics.</p>
<p>4) The WTID record contains information that remains consistent for the duration of the task, with 
the exception of the ‘Date and Time’ fields. It also contains some potentially very useful 
information like the connection name and application information.</p>
<p>5) The WTAS record (tasks statistics) contains the date and time of the interval, the start date and 
time for the task, and task specific data that we often use for performance issues – including 
latching information and CF calls that are at the task level.</p>
<p>6) The WQ records (task queue records) contain the interval data and time, and very detailed 
information about the queue’s disposition and use by this task. It includes specifics about the 
MQAPI calls not found elsewhere and calls to the CF to satisfy the API request. The queue 
statistics added with IBM MQ for z/OS 9.3.3 does not include this detailed breakdown of the API 
requests.</p>
<p>7) LRTs require special treatment, for example after the first set of records for the LRT, counts are 
set to zero at SMF intervals.</p>
<p>a) If you do not have the ‘first instance’ of the task in the data being examined, some 
information may be hard to discern. For example, the use of selectors on MQGET processing. 
The Selector count and length are set at MQOPEN time, and when an open is only done at the 
start of a task subsequent records do not clearly indicate selector use. However, if all MQGET 
requests show that they are for specific records and the queue is both shared and non-indexed 
it is usually safe to assume that selectors are in use. </p>
<p>b) Note that if an MQGET is done against a shared queue , has a 'typical' match option, and the 
queue is not indexed properly; that MQGET will fail with a 2207 (CORREL_ID_ERROR).</p>
<p>c) If the information is needed from start to finish for a particular task, the Accounting Class(3) 
data should be started at queue manager start-up, or before the task is started and continue 
until the task has ended, or until the next restart of the queue manager.</p>
<p>8) To get the correct records to align for LRTs, several fields must be matched between the three 
tables. They are listed here with the name of the table included as a qualifier:
WTID.WTAS_CORRELATOR, WTAS.CORREL, WQ.CORRELATION
WTID.DATE, WTAS.DATE, WQ.DATE
WTID.TIME, WTAS.TIME, WQ.TIME
WTID.LPAR, WTAS.LPAR, WQ.LPAR
WTID.QMGR, WTAS.QMGR, WQ.QMGR</p>
<p>9) The WHERE clause in queries to associate the correct WTID, WTAS and WQ records looks 
something like this:
WHERE (WTID.WTAS_CORRELATOR = WTAS.CORREL AND
WTAS.CORREL = WQ.CORRELATION AND 
WTID.DATE = WTAS.DATE AND
WTAS.DATE = WQ.DATE AND
WTID.TIME = WTAS.TIME AND 
WTAS.TIME = WQ.TIME AND
WTID.LPAR = WTAS.LPAR AND
WTAS.LPAR = WQ.LPAR AND
WTID.QMGR = WTAS.QMGR AND
WTAS.QMGR = WQ.QMGR )</p>
<p>10) The WHERE clause may be extended to return rows for just about anything, including a specific 
date, queues that are on a specific structure (WQ.CF_STRUCTURE), a specific queue, or as in this 
investigation looking for all queues hosted on a designated structure and where the get count 
(WQ.GET_COUNT) is greater than zero.</p>
<p>11) If your investigation includes data from more than one queue sharing group, defining views for 
each QSG is necessary when the same structure names are used by more than one QSG. Please 
see the previous article for directions on setting up those views.</p>
<p>12) All MQ API requests are broken down into one or more calls to the coupling facility, depending 
on the attributes of the request. This activity is reported in the WQ records, for queue-based
activity, and the WTAS record for task related requests (commit, backout) and each record type 
includes the range of CF requests that may be used to fulfill the MQ API request. We had to 
focus on queue activity for this investigation.</p>
<p>13) Don't feel daunted by the volume and complexity of the task related data, it can be 
overwhelming when you first look at it. Thought is required to determine just how to 
consolidate the data into useful information that can be used to make decisions about both 
application and infrastructure patterns. It took several rounds of SQL attempts to get data in a 
usable form with the information we were looking for, and we work with this kind of data 
regularly.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2025 IBM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>